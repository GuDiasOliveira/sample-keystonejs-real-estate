extends ../layouts/default

block intro
	.container
		h1 My properties
	
block content
	.container
		.properties
			each property in properties
				.property-item.col-sm-4.col-md-4
					a(href=`/property/${property._id}`)
						h2.property-name= property.name || '<property>'
					a(href=`/property/${property._id}`)
						.property-thumb-image.thumbnail
							if property.thumbPhoto.exists
								img(src=property._.thumbPhoto.fit(300, 200)).img-rounded
							else
								.no-thumb-image
									p No thumbnail image!
					.property-id.text-muted Ref. #{property._id}
					.property-price R$ #{property.price}
					.property-type= propertyTypes[property.propType].label
					.row.property-areas-rooms
						.col-md-4
							p <strong>#{property.totalArea} m²</strong><br />total area
						.col-md-4
							p <strong>#{property.usefulArea} m²</strong><br />useful area
						.col-md-4
							p <strong>#{property.rooms}</strong><br />#{property.rooms != 1 ? 'rooms' : 'room'}
			else
				h2.properties-empty No properties
		-
			let currentPage = +urlParams.page || 1;
			let minPage = Math.max(currentPage - parseInt(maxPagesListing / 2) , 1);
			let maxPagesCount = Math.max(1, Math.ceil(propertiesCount / perPage));
			let maxPage = Math.min(minPage + maxPagesListing - 1, maxPagesCount);
			let pageLinkParams = Object.assign({}, urlParams);
		if maxPagesCount > 1
			ul.pagination
				//- Start page
				if currentPage > 2
					- pageLinkParams.page = 1;
					li(): a(href=buildUrl('/', { queryParams: pageLinkParams })) &lt;&lt;&lt;
				//- Previous page
				if currentPage > 1
					- pageLinkParams.page = currentPage - 1;
					li(): a(href=buildUrl('/', { queryParams: pageLinkParams })) &lt;&lt;
				//- Pages
				- for (let p = minPage; p <= maxPage; p++)
					- pageLinkParams.page = p;
					li(class=(p == currentPage && 'active')): a(href=buildUrl('/', { queryParams: pageLinkParams }))= p
				//- Next page
				if currentPage < maxPagesCount
					- pageLinkParams.page = currentPage + 1;
					li(): a(href=buildUrl('/', { queryParams: pageLinkParams })) &gt;&gt;
				//- End page
				if currentPage < (maxPagesCount - 1)
					- pageLinkParams.page = maxPagesCount;
					li(): a(href=buildUrl('/', { queryParams: pageLinkParams })) &gt;&gt;&gt;
